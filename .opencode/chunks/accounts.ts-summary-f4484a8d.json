{
  "id": "accounts.ts-summary-f4484a8d",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/accounts.ts",
  "chunk_type": "summary",
  "content": "# Summary: accounts.ts\n\n## File Type\n.ts - TypeScript source file\n\n## Purpose\nPurpose not explicitly documented\n\n## Key Components\n\n### Functions (9)\n- **parseRateLimitReason**: No documentation found\n- **calculateBackoffMs**: No documentation found\n- **nowMs**: No documentation found\n- **clampNonNegativeInt**: No documentation found\n- **getQuotaKey**: No documentation found\n- **isRateLimitedForQuotaKey**: No documentation found\n- **isRateLimitedForFamily**: No documentation found\n- **isRateLimitedForHeaderStyle**: No documentation found\n- **clearExpiredRateLimits**: No documentation found\n\n\n\n### Classes (1)\n- **AccountManager**: In-memory multi-account manager with sticky account selection.\n\nUses the same account until it hits a rate limit (429), then switches.\nRate limits are tracked per-model-family (claude/gemini) so an account\nrate-limited for Claude can still be used for Gemini.\n\nSource of truth for the pool is `antigravity-accounts.json`.\n\n\n## Dependencies\n- ./auth\n- ./storage\n- ./types\n- ./config/schema\n- ./rotation\n\n## Exports\n- RateLimitReason\n- RateLimitBackoffResult\n- parseRateLimitReason\n- calculateBackoffMs\n- BaseQuotaKey\n- QuotaKey\n- ManagedAccount\n- AccountManager\n\n## Complexity Metrics\n- Lines of code: 716\n- Estimated complexity: 100/100\n\n## Notes\nNo specific notes found",
  "metadata": {
    "created_at": "2026-01-30T05:26:51.912Z",
    "updated_at": "2026-01-30T05:26:51.912Z",
    "hash": "0a449175cfc96f242cdf099be50d3194880bf045efe1cb00d1a91caa51303dec",
    "dependencies": [
      "./auth",
      "./storage",
      "./types",
      "./config/schema",
      "./rotation"
    ],
    "symbols": [
      "RateLimitReason",
      "RateLimitBackoffResult",
      "QUOTA_EXHAUSTED_BACKOFFS",
      "RATE_LIMIT_EXCEEDED_BACKOFF",
      "MODEL_CAPACITY_EXHAUSTED_BACKOFF",
      "SERVER_ERROR_BACKOFF",
      "UNKNOWN_BACKOFF",
      "MIN_BACKOFF_MS",
      "parseRateLimitReason",
      "lower",
      "calculateBackoffMs",
      "index",
      "BaseQuotaKey",
      "QuotaKey",
      "ManagedAccount",
      "nowMs",
      "clampNonNegativeInt",
      "getQuotaKey",
      "base",
      "isRateLimitedForQuotaKey",
      "resetTime",
      "isRateLimitedForFamily",
      "antigravityIsLimited",
      "cliIsLimited",
      "isRateLimitedForHeaderStyle",
      "modelKey",
      "baseKey",
      "clearExpiredRateLimits",
      "now",
      "keys",
      "key",
      "resetTime",
      "AccountManager",
      "stored",
      "authParts",
      "baseNow",
      "matchesFallback",
      "defaultIndex",
      "authParts",
      "hasMatching",
      "now",
      "newAccount",
      "parts",
      "now",
      "currentIndex",
      "now",
      "quotaKey",
      "next",
      "healthTracker",
      "tokenTracker",
      "accountsWithMetrics",
      "selectedIndex",
      "selected",
      "pidOffset",
      "baseIndex",
      "current",
      "isLimitedForRequestedStyle",
      "next",
      "available",
      "account",
      "key",
      "failures",
      "backoffMs",
      "key",
      "account",
      "antigravityKey",
      "cliKey",
      "minWaitMs",
      "touchedAt",
      "resetTime",
      "idx",
      "family",
      "parts",
      "available",
      "waitTimes",
      "a",
      "t",
      "antigravityKey",
      "cliKey",
      "t1",
      "t2",
      "accountWait",
      "claudeIndex",
      "geminiIndex",
      "storage",
      "resolvers",
      "resolve"
    ],
    "complexity_score": 100
  }
}