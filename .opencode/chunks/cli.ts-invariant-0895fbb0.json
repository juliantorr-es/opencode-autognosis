{
  "id": "cli.ts-invariant-0895fbb0",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-supermemory/src/cli.ts",
  "chunk_type": "invariant",
  "content": "# Invariants: cli.ts\n\n## Core Invariants\n\n\n## Constraints\n- **OPENCODE_CONFIG_DIR**: join(homedir(), \".config\", \"opencode\")\n- **OPENCODE_COMMAND_DIR**: join(OPENCODE_CONFIG_DIR, \"command\")\n- **OH_MY_OPENCODE_CONFIG**: join(OPENCODE_CONFIG_DIR, \"oh-my-opencode.json\")\n- **PLUGIN_NAME**: \"opencode-supermemory@latest\"\n- **SUPERMEMORY_INIT_COMMAND**: `---\ndescription: Initialize Supermemory with comprehensive codebase knowledge\n---\n\n# Initializing Supermemory\n\nYou are initializing persistent memory for this codebase. This is not just data collection - you're building context that will make you significantly more effective across all future sessions.\n\n## Understanding Context\n\nYou are a **stateful** coding agent. Users expect to work with you over extended periods - potentially the entire lifecycle of a project. Your memory is how you get better over time and maintain continuity.\n\n## What to Remember\n\n### 1. Procedures (Rules & Workflows)\nExplicit rules that should always be followed:\n- \"Never commit directly to main - always use feature branches\"\n- \"Always run lint before tests\"\n- \"Use conventional commits format\"\n\n### 2. Preferences (Style & Conventions)  \nProject and user coding style:\n- \"Prefer functional components over class components\"\n- \"Use early returns instead of nested conditionals\"\n- \"Always add JSDoc to exported functions\"\n\n### 3. Architecture & Context\nHow the codebase works and why:\n- \"Auth system was refactored in v2.0 - old patterns deprecated\"\n- \"The monorepo used to have 3 modules before consolidation\"\n- \"This pagination bug was fixed before - similar to PR #234\"\n\n## Memory Scopes\n\n**Project-scoped** (\\`scope: \"project\"\\`):\n- Build/test/lint commands\n- Architecture and key directories\n- Team conventions specific to this codebase\n- Technology stack and framework choices\n- Known issues and their solutions\n\n**User-scoped** (\\`scope: \"user\"\\`):\n- Personal coding preferences across all projects\n- Communication style preferences\n- General workflow habits\n\n## Research Approach\n\nThis is a **deep research** initialization. Take your time and be thorough (~50+ tool calls). The goal is to genuinely understand the project, not just collect surface-level facts.\n\n**What to uncover:**\n- Tech stack and dependencies (explicit and implicit)\n- Project structure and architecture\n- Build/test/deploy commands and workflows\n- Contributors & team dynamics (who works on what?)\n- Commit conventions and branching strategy\n- Code evolution (major refactors, architecture changes)\n- Pain points (areas with lots of bug fixes)\n- Implicit conventions not documented anywhere\n\n## Research Techniques\n\n### File-based\n- README.md, CONTRIBUTING.md, AGENTS.md, CLAUDE.md\n- Package manifests (package.json, Cargo.toml, pyproject.toml, go.mod)\n- Config files (.eslintrc, tsconfig.json, .prettierrc)\n- CI/CD configs (.github/workflows/)\n\n### Git-based\n- \\`git log --oneline -20\\` - Recent history\n- \\`git branch -a\\` - Branching strategy  \n- \\`git log --format\n\n## Assumptions\n\n\n## State Management\nNo explicit state management patterns detected\n\n## Error Handling\nError handling metrics: 5 try-catch blocks, 0 throw statements\n\n## Performance Considerations\nNo obvious performance optimization patterns detected\n\n## Security Considerations\nNo obvious security risks detected via static analysis",
  "metadata": {
    "created_at": "2026-01-30T05:26:52.356Z",
    "updated_at": "2026-01-30T05:26:52.356Z",
    "hash": "ae7f568c28d107443327e0969fbc1db2e4a8f3b3d611b26d2eef7c11d412f06f",
    "dependencies": [
      "node:fs",
      "node:path",
      "node:os",
      "node:readline",
      "./services/jsonc.js"
    ],
    "symbols": [
      "OPENCODE_CONFIG_DIR",
      "OPENCODE_COMMAND_DIR",
      "OH_MY_OPENCODE_CONFIG",
      "PLUGIN_NAME",
      "SUPERMEMORY_INIT_COMMAND",
      "createReadline",
      "confirm",
      "findOpencodeConfig",
      "candidates",
      "path",
      "addPluginToConfig",
      "content",
      "jsonContent",
      "config",
      "plugins",
      "newContent",
      "trimmed",
      "newContent",
      "err",
      "createNewConfig",
      "configPath",
      "config",
      "createCommand",
      "commandPath",
      "isOhMyOpencodeInstalled",
      "configPath",
      "content",
      "isAutoCompactAlreadyDisabled",
      "content",
      "config",
      "disabledHooks",
      "disableAutoCompactHook",
      "config",
      "content",
      "disabledHooks",
      "err",
      "InstallOptions",
      "install",
      "rl",
      "configPath",
      "shouldModify",
      "shouldCreate",
      "shouldCreate",
      "shouldDisable",
      "printHelp",
      "args",
      "noTui",
      "disableAutoCompact",
      "noTui",
      "disableAutoCompact"
    ],
    "complexity_score": 100
  }
}