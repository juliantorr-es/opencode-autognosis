{
  "id": "accounts.ts-invariant-f4484a8d",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/accounts.ts",
  "chunk_type": "invariant",
  "content": "# Invariants: accounts.ts\n\n## Core Invariants\n\n\n## Constraints\n- **QUOTA_EXHAUSTED_BACKOFFS**: [60_000, 300_000, 1_800_000, 7_200_000] as const\n- **RATE_LIMIT_EXCEEDED_BACKOFF**: 30_000\n- **MODEL_CAPACITY_EXHAUSTED_BACKOFF**: 15_000\n- **SERVER_ERROR_BACKOFF**: 20_000\n- **UNKNOWN_BACKOFF**: 60_000\n- **MIN_BACKOFF_MS**: 2_000\n\n## Assumptions\n\n\n## State Management\nNo explicit state management patterns detected\n\n## Error Handling\nError handling metrics: 1 try-catch blocks, 0 throw statements\n\n## Performance Considerations\nNo obvious performance optimization patterns detected\n\n## Security Considerations\nNo obvious security risks detected via static analysis",
  "metadata": {
    "created_at": "2026-01-30T05:26:51.915Z",
    "updated_at": "2026-01-30T05:26:51.915Z",
    "hash": "d9a26604f952a21d59b851172e90d3d8e135c03a592959520d322103c0fe43a2",
    "dependencies": [
      "./auth",
      "./storage",
      "./types",
      "./config/schema",
      "./rotation"
    ],
    "symbols": [
      "RateLimitReason",
      "RateLimitBackoffResult",
      "QUOTA_EXHAUSTED_BACKOFFS",
      "RATE_LIMIT_EXCEEDED_BACKOFF",
      "MODEL_CAPACITY_EXHAUSTED_BACKOFF",
      "SERVER_ERROR_BACKOFF",
      "UNKNOWN_BACKOFF",
      "MIN_BACKOFF_MS",
      "parseRateLimitReason",
      "lower",
      "calculateBackoffMs",
      "index",
      "BaseQuotaKey",
      "QuotaKey",
      "ManagedAccount",
      "nowMs",
      "clampNonNegativeInt",
      "getQuotaKey",
      "base",
      "isRateLimitedForQuotaKey",
      "resetTime",
      "isRateLimitedForFamily",
      "antigravityIsLimited",
      "cliIsLimited",
      "isRateLimitedForHeaderStyle",
      "modelKey",
      "baseKey",
      "clearExpiredRateLimits",
      "now",
      "keys",
      "key",
      "resetTime",
      "AccountManager",
      "stored",
      "authParts",
      "baseNow",
      "matchesFallback",
      "defaultIndex",
      "authParts",
      "hasMatching",
      "now",
      "newAccount",
      "parts",
      "now",
      "currentIndex",
      "now",
      "quotaKey",
      "next",
      "healthTracker",
      "tokenTracker",
      "accountsWithMetrics",
      "selectedIndex",
      "selected",
      "pidOffset",
      "baseIndex",
      "current",
      "isLimitedForRequestedStyle",
      "next",
      "available",
      "account",
      "key",
      "failures",
      "backoffMs",
      "key",
      "account",
      "antigravityKey",
      "cliKey",
      "minWaitMs",
      "touchedAt",
      "resetTime",
      "idx",
      "family",
      "parts",
      "available",
      "waitTimes",
      "a",
      "t",
      "antigravityKey",
      "cliKey",
      "t1",
      "t2",
      "accountWait",
      "claudeIndex",
      "geminiIndex",
      "storage",
      "resolvers",
      "resolve"
    ],
    "complexity_score": 100
  }
}