{
  "id": "cache.ts-api-c2ac4688",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/cache.ts",
  "chunk_type": "api",
  "content": "# API Surface: cache.ts\n\n## Public Functions\n\n### resolveCachedAuth\n```typescript\nexport function resolveCachedAuth(auth: OAuthAuthDetails): OAuthAuthDetails\n```\nReturns a cached auth snapshot when available, favoring unexpired tokens.\n\n**Parameters:**\n- `auth`: OAuthAuthDetails - \n\n**Returns:** OAuthAuthDetails\n\n\n### storeCachedAuth\n```typescript\nexport function storeCachedAuth(auth: OAuthAuthDetails): void\n```\nStores the latest auth snapshot keyed by refresh token.\n\n**Parameters:**\n- `auth`: OAuthAuthDetails - \n\n**Returns:** void\n\n\n### clearCachedAuth\n```typescript\nexport function clearCachedAuth(refresh?: string): void\n```\nClears cached auth globally or for a specific refresh token.\n\n**Parameters:**\n- `refresh`: string - \n\n**Returns:** void\n\n\n### initDiskSignatureCache\n```typescript\nexport function initDiskSignatureCache(config: SignatureCacheConfig | undefined): SignatureCache | null\n```\nInitialize the disk-based signature cache.\nCall this from plugin initialization when keep_thinking is enabled.\n\n**Parameters:**\n- `config`: SignatureCacheConfig | undefined - \n\n**Returns:** SignatureCache | null\n\n\n### getDiskSignatureCache\n```typescript\nexport function getDiskSignatureCache(): SignatureCache | null\n```\nGet the disk cache instance (for testing/debugging).\n\n**Returns:** SignatureCache | null\n\n\n### cacheSignature\n```typescript\nexport function cacheSignature(sessionId: string, text: string, signature: string): void\n```\nCaches a thinking signature for a given session and text.\nUsed for Claude models that require signed thinking blocks in multi-turn conversations.\nAlso writes to disk cache if enabled.\n\n**Parameters:**\n- `sessionId`: string - \n- `text`: string - \n- `signature`: string - \n\n**Returns:** void\n\n\n### getCachedSignature\n```typescript\nexport function getCachedSignature(sessionId: string, text: string): string | undefined\n```\nRetrieves a cached signature for a given session and text.\nChecks memory first, then falls back to disk cache.\nReturns undefined if not found or expired.\n\n**Parameters:**\n- `sessionId`: string - \n- `text`: string - \n\n**Returns:** string | undefined\n\n\n### clearSignatureCache\n```typescript\nexport function clearSignatureCache(sessionId?: string): void\n```\nClears signature cache for a specific session or all sessions.\nAlso clears from disk cache if enabled.\n\n**Parameters:**\n- `sessionId`: string - \n\n**Returns:** void\n\n\n## Classes\n\n\n## Interfaces\n\n### SignatureEntry\n```typescript\ninterface SignatureEntry\n```\nNo documentation found\n\n\n## Types\n",
  "metadata": {
    "created_at": "2026-01-30T05:26:51.929Z",
    "updated_at": "2026-01-30T05:26:51.929Z",
    "hash": "6c0fbddeae44624996d3aaac4fb252abd2f1a6c0680f5ba73a056bca1e878dbd",
    "dependencies": [
      "./auth",
      "./types",
      "node:crypto",
      "./cache/signature-cache",
      "./config"
    ],
    "symbols": [
      "authCache",
      "normalizeRefreshKey",
      "key",
      "resolveCachedAuth",
      "key",
      "cached",
      "storeCachedAuth",
      "key",
      "clearCachedAuth",
      "key",
      "SignatureEntry",
      "signatureCache",
      "SIGNATURE_CACHE_TTL_MS",
      "MAX_ENTRIES_PER_SESSION",
      "SIGNATURE_TEXT_HASH_HEX_LEN",
      "diskCache",
      "initDiskSignatureCache",
      "getDiskSignatureCache",
      "hashText",
      "makeDiskKey",
      "cacheSignature",
      "textHash",
      "sessionMemCache",
      "now",
      "entries",
      "toRemove",
      "diskKey",
      "getCachedSignature",
      "textHash",
      "sessionMemCache",
      "entry",
      "diskKey",
      "diskValue",
      "memCache",
      "clearSignatureCache"
    ],
    "complexity_score": 100
  }
}