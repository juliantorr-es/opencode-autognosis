{
  "id": "git-worktree.ts-invariant-203862e2",
  "file_path": "/Users/user/opencode-autognosis/src/git-worktree.ts",
  "chunk_type": "invariant",
  "content": "# Invariants: git-worktree.ts\n\n## Core Invariants\n\n\n## Constraints\n- **PROJECT_ROOT**: process.cwd()\n- **OPENCODE_DIR**: path.join(PROJECT_ROOT, \".opencode\")\n- **WORKTREE_DIR**: path.join(OPENCODE_DIR, \"worktrees\")\n- **AGENT_USAGE_POLICY**: `\nAGENT USAGE POLICY:\n- Use git.preflight before any repository operations\n- Create checkpoints with git.checkpoint_create for clean session starts\n- Work in integration branches, never directly on main/master\n- Validate all patches before application\n- Clean up worktrees after completion to avoid resource leaks\n`.trim()\n- **WORKFLOW_PATTERNS**: `\nSTANDARD WORKFLOW:\n1. git.preflight -> Validate repository state\n2. git.checkpoint_create -> Create clean starting point\n3. Work in feature/integration branch\n4. git.validate_patch -> Verify changes before commit\n5. Clean up worktrees and finalize\n`.trim()\n\n## Assumptions\n\n\n## State Management\nNo explicit state management patterns detected\n\n## Error Handling\nError handling metrics: 7 try-catch blocks, 0 throw statements\n\n## Performance Considerations\nNo obvious performance optimization patterns detected\n\n## Security Considerations\nNo obvious security risks detected via static analysis",
  "metadata": {
    "created_at": "2026-01-30T05:26:52.420Z",
    "updated_at": "2026-01-30T05:26:52.420Z",
    "hash": "73501c83fc89be9597c947786e88fb6a33bac12dc625c28dfac50b3f4a0b8940",
    "dependencies": [
      "@opencode-ai/plugin",
      "node:child_process",
      "node:fs/promises",
      "node:fs",
      "node:path",
      "node:util",
      "node:crypto"
    ],
    "symbols": [
      "execAsync",
      "PROJECT_ROOT",
      "OPENCODE_DIR",
      "WORKTREE_DIR",
      "log",
      "runCmd",
      "error",
      "ensureWorktreeDir",
      "getGitState",
      "discoverWorktrees",
      "worktrees",
      "results",
      "worktree",
      "worktreePath",
      "stat",
      "gitDir",
      "error",
      "AGENT_USAGE_POLICY",
      "WORKFLOW_PATTERNS",
      "gitWorktreeTools",
      "state",
      "worktrees",
      "issues",
      "warnings",
      "conflictingWorktrees",
      "result",
      "error",
      "state",
      "targetBranch",
      "worktreePath",
      "result",
      "error",
      "worktrees",
      "state",
      "filteredWorktrees",
      "result",
      "error",
      "worktrees",
      "targetWorktrees",
      "cleanupResults",
      "warnings",
      "worktree",
      "error",
      "result",
      "error"
    ],
    "complexity_score": 100
  }
}