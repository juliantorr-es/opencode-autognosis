{
  "id": "get-project-id.ts-summary-111b0b6d",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-worktree/src/plugin/kdco-primitives/get-project-id.ts",
  "chunk_type": "summary",
  "content": "# Summary: get-project-id.ts\n\n## File Type\n.ts - TypeScript source file\n\n## Purpose\nPurpose not explicitly documented\n\n## Key Components\n\n### Functions (2)\n- **hashPath**: Generate a short hash from a path for project ID fallback.\n\nUsed when git root commit is unavailable (non-git repos, empty repos).\nProduces a 16-character hex string for reasonable uniqueness.\n- **getProjectId**: Generate a unique project ID from the project root path.\n\n**Strategy:**\n1. Uses the first root commit SHA for stability across renames/moves\n2. Falls back to path hash for non-git repos or empty repos\n3. Caches result in .git/opencode for performance\n\n**Git Worktree Support:**\nWhen .git is a file (worktree), resolves the actual .git directory\nand uses the shared cache. This ensures all worktrees share the same\nproject ID and associated data.\n\n\n\n\n## Dependencies\n- node:crypto\n- node:fs/promises\n- node:path\n- ./log-warn\n- ./types\n- ./with-timeout\n\n## Exports\n- getProjectId\n\n## Complexity Metrics\n- Lines of code: 173\n- Estimated complexity: 100/100\n\n## Notes\nNo specific notes found",
  "metadata": {
    "created_at": "2026-01-30T05:26:52.376Z",
    "updated_at": "2026-01-30T05:26:52.376Z",
    "hash": "e9ba9ac4a191d02f8328e3312a31f91ef24da832529dd004b695b6e3b3f8e6c1",
    "dependencies": [
      "node:crypto",
      "node:fs/promises",
      "node:path",
      "./log-warn",
      "./types",
      "./with-timeout"
    ],
    "symbols": [
      "hashPath",
      "hash",
      "getProjectId",
      "gitPath",
      "gitStat",
      "gitDir",
      "content",
      "match",
      "gitdirPath",
      "resolvedGitdir",
      "commondirPath",
      "commondirFile",
      "commondirContent",
      "gitDirStat",
      "cacheFile",
      "cache",
      "cached",
      "proc",
      "timeoutMs",
      "exitCode",
      "output",
      "roots",
      "projectId",
      "e",
      "stderr",
      "error"
    ],
    "complexity_score": 100
  }
}