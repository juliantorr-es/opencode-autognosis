{
  "id": "debug.ts-summary-e55102a9",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/debug.ts",
  "chunk_type": "summary",
  "content": "# Summary: debug.ts\n\n## File Type\n.ts - TypeScript source file\n\n## Purpose\nDocumented purpose found in JSDoc\n\n## Key Components\n\n### Functions (23)\n- **parseDebugLevel**: Parse debug level from a flag string.\n0 = off, 1 = basic, 2 = verbose (full bodies)\n- **getConfigDir**: Get the OS-specific config directory.\n- **getLogsDir**: Returns the logs directory, creating it if needed.\n- **createLogFilePath**: Builds a timestamped log file path.\n- **createLogWriter**: Creates a log writer function that writes to a file.\n- **initializeDebug**: Initialize or reinitialize debug state with the given config.\nCall this once at plugin startup after loading config.\n- **getDebugState**: Get the current debug state, initializing with defaults if needed.\nThis allows the module to work even before initializeDebug is called.\n- **isDebugEnabled**: No documentation found\n- **isVerboseEnabled**: No documentation found\n- **getLogFilePath**: No documentation found\n- **startAntigravityDebugRequest**: Begins a debug trace for an Antigravity request.\n- **logAntigravityDebugResponse**: Logs response details for a previously started debug trace.\n- **maskHeaders**: Obscures sensitive headers and returns a plain object for logging.\n- **formatBodyPreview**: Produces a short, type-aware preview of a request/response body for logs.\n- **truncateForLog**: Truncates long strings to a fixed preview length for logging.\n- **logDebug**: Writes a single debug line using the configured writer.\n- **formatError**: Converts unknown error-like values into printable strings.\n- **logAccountContext**: No documentation found\n- **logRateLimitEvent**: No documentation found\n- **logRateLimitSnapshot**: No documentation found\n- **logResponseBody**: No documentation found\n- **logModelFamily**: No documentation found\n- **debugLogToFile**: No documentation found\n\n\n\n\n## Dependencies\n- node:fs\n- node:path\n- node:os\n- node:process\n- ./config\n- ./storage\n\n## Exports\n- DEBUG_MESSAGE_PREFIX\n- initializeDebug\n- isDebugEnabled\n- isVerboseEnabled\n- getLogFilePath\n- AntigravityDebugContext\n- startAntigravityDebugRequest\n- logAntigravityDebugResponse\n- AccountDebugInfo\n- logAccountContext\n- logRateLimitEvent\n- logRateLimitSnapshot\n- logResponseBody\n- logModelFamily\n- debugLogToFile\n\n## Complexity Metrics\n- Lines of code: 434\n- Estimated complexity: 100/100\n\n## Notes\nNo specific notes found",
  "metadata": {
    "created_at": "2026-01-30T05:26:51.950Z",
    "updated_at": "2026-01-30T05:26:51.950Z",
    "hash": "b6bf6a74f050e25773f8c1d10a95758a1763f535b8676847d69b356c3aeb1af5",
    "dependencies": [
      "node:fs",
      "node:path",
      "node:os",
      "node:process",
      "./config",
      "./storage"
    ],
    "symbols": [
      "MAX_BODY_PREVIEW_CHARS",
      "MAX_BODY_VERBOSE_CHARS",
      "DEBUG_MESSAGE_PREFIX",
      "DebugState",
      "debugState",
      "parseDebugLevel",
      "trimmed",
      "getConfigDir",
      "platform",
      "xdgConfig",
      "getLogsDir",
      "logsDir",
      "createLogFilePath",
      "timestamp",
      "createLogWriter",
      "stream",
      "timestamp",
      "formatted",
      "initializeDebug",
      "envDebugFlag",
      "debugLevel",
      "debugEnabled",
      "verboseEnabled",
      "logFilePath",
      "logWriter",
      "getDebugState",
      "envDebugFlag",
      "debugLevel",
      "debugEnabled",
      "verboseEnabled",
      "logFilePath",
      "logWriter",
      "isDebugEnabled",
      "isVerboseEnabled",
      "getLogFilePath",
      "AntigravityDebugContext",
      "AntigravityDebugRequestMeta",
      "AntigravityDebugResponseMeta",
      "requestCounter",
      "startAntigravityDebugRequest",
      "state",
      "id",
      "method",
      "bodyPreview",
      "logAntigravityDebugResponse",
      "state",
      "durationMs",
      "maskHeaders",
      "result",
      "parsed",
      "formatBodyPreview",
      "truncateForLog",
      "logDebug",
      "formatError",
      "AccountDebugInfo",
      "logAccountContext",
      "accountLabel",
      "indexLabel",
      "rateLimitInfo",
      "logRateLimitEvent",
      "accountLabel",
      "logRateLimitSnapshot",
      "now",
      "entries",
      "label",
      "reset",
      "remaining",
      "seconds",
      "logResponseBody",
      "state",
      "isError",
      "shouldLogBody",
      "text",
      "maxChars",
      "preview",
      "e",
      "logModelFamily",
      "debugLogToFile"
    ],
    "complexity_score": 100
  }
}