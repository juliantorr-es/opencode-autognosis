{
  "id": "cache.ts-summary-c2ac4688",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/cache.ts",
  "chunk_type": "summary",
  "content": "# Summary: cache.ts\n\n## File Type\n.ts - TypeScript source file\n\n## Purpose\nDocumented purpose found in JSDoc\n\n## Key Components\n\n### Functions (11)\n- **normalizeRefreshKey**: Produces a stable cache key from a refresh token string.\n- **resolveCachedAuth**: Returns a cached auth snapshot when available, favoring unexpired tokens.\n- **storeCachedAuth**: Stores the latest auth snapshot keyed by refresh token.\n- **clearCachedAuth**: Clears cached auth globally or for a specific refresh token.\n- **initDiskSignatureCache**: Initialize the disk-based signature cache.\nCall this from plugin initialization when keep_thinking is enabled.\n- **getDiskSignatureCache**: Get the disk cache instance (for testing/debugging).\n- **hashText**: Hashes text content into a stable, Unicode-safe key.\n\nUses SHA-256 over UTF-8 bytes and truncates to keep memory usage bounded.\n- **makeDiskKey**: Create a disk cache key from sessionId and textHash.\n- **cacheSignature**: Caches a thinking signature for a given session and text.\nUsed for Claude models that require signed thinking blocks in multi-turn conversations.\nAlso writes to disk cache if enabled.\n- **getCachedSignature**: Retrieves a cached signature for a given session and text.\nChecks memory first, then falls back to disk cache.\nReturns undefined if not found or expired.\n- **clearSignatureCache**: Clears signature cache for a specific session or all sessions.\nAlso clears from disk cache if enabled.\n\n\n\n\n## Dependencies\n- ./auth\n- ./types\n- node:crypto\n- ./cache/signature-cache\n- ./config\n\n## Exports\n- resolveCachedAuth\n- storeCachedAuth\n- clearCachedAuth\n- initDiskSignatureCache\n- getDiskSignatureCache\n- cacheSignature\n- getCachedSignature\n- clearSignatureCache\n\n## Complexity Metrics\n- Lines of code: 238\n- Estimated complexity: 100/100\n\n## Notes\nNo specific notes found",
  "metadata": {
    "created_at": "2026-01-30T05:26:51.929Z",
    "updated_at": "2026-01-30T05:26:51.929Z",
    "hash": "428cb7535ae2fbdae4e144d52ec991843bbdee40ef67fdc44b147701f5ef5c15",
    "dependencies": [
      "./auth",
      "./types",
      "node:crypto",
      "./cache/signature-cache",
      "./config"
    ],
    "symbols": [
      "authCache",
      "normalizeRefreshKey",
      "key",
      "resolveCachedAuth",
      "key",
      "cached",
      "storeCachedAuth",
      "key",
      "clearCachedAuth",
      "key",
      "SignatureEntry",
      "signatureCache",
      "SIGNATURE_CACHE_TTL_MS",
      "MAX_ENTRIES_PER_SESSION",
      "SIGNATURE_TEXT_HASH_HEX_LEN",
      "diskCache",
      "initDiskSignatureCache",
      "getDiskSignatureCache",
      "hashText",
      "makeDiskKey",
      "cacheSignature",
      "textHash",
      "sessionMemCache",
      "now",
      "entries",
      "toRemove",
      "diskKey",
      "getCachedSignature",
      "textHash",
      "sessionMemCache",
      "entry",
      "diskKey",
      "diskValue",
      "memCache",
      "clearSignatureCache"
    ],
    "complexity_score": 100
  }
}