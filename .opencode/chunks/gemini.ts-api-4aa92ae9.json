{
  "id": "gemini.ts-api-4aa92ae9",
  "file_path": "/Users/user/opencode-autognosis/reference repos/opencode-antigravity-auth/src/plugin/transform/gemini.ts",
  "chunk_type": "api",
  "content": "# API Surface: gemini.ts\n\n## Public Functions\n\n### toGeminiSchema\n```typescript\nexport function toGeminiSchema(schema: unknown): unknown\n```\nNo documentation found\n\n**Parameters:**\n- `schema`: unknown - \n\n**Returns:** unknown\n\n\n### isGeminiModel\n```typescript\nexport function isGeminiModel(model: string): boolean\n```\nCheck if a model is a Gemini model (not Claude).\n\n**Parameters:**\n- `model`: string - \n\n**Returns:** boolean\n\n\n### isGemini3Model\n```typescript\nexport function isGemini3Model(model: string): boolean\n```\nCheck if a model is Gemini 3 (uses thinkingLevel string).\n\n**Parameters:**\n- `model`: string - \n\n**Returns:** boolean\n\n\n### isGemini25Model\n```typescript\nexport function isGemini25Model(model: string): boolean\n```\nCheck if a model is Gemini 2.5 (uses numeric thinkingBudget).\n\n**Parameters:**\n- `model`: string - \n\n**Returns:** boolean\n\n\n### isImageGenerationModel\n```typescript\nexport function isImageGenerationModel(model: string): boolean\n```\nCheck if a model is an image generation model.\nImage models don't support thinking and require imageConfig.\n\n**Parameters:**\n- `model`: string - \n\n**Returns:** boolean\n\n\n### buildGemini3ThinkingConfig\n```typescript\nexport function buildGemini3ThinkingConfig(\n  includeThoughts: boolean,\n  thinkingLevel: ThinkingTier,\n): ThinkingConfig\n```\nBuild Gemini 3 thinking config with thinkingLevel string.\n\n**Parameters:**\n- `includeThoughts`: boolean - \n- `thinkingLevel`: ThinkingTier - \n\n**Returns:** ThinkingConfig\n\n\n### buildGemini25ThinkingConfig\n```typescript\nexport function buildGemini25ThinkingConfig(\n  includeThoughts: boolean,\n  thinkingBudget?: number,\n): ThinkingConfig\n```\nBuild Gemini 2.5 thinking config with numeric thinkingBudget.\n\n**Parameters:**\n- `includeThoughts`: boolean - \n- `thinkingBudget`: number - \n\n**Returns:** ThinkingConfig\n\n\n### buildImageGenerationConfig\n```typescript\nexport function buildImageGenerationConfig(): ImageConfig\n```\nBuild image generation config for Gemini image models.\n\nConfiguration is read from environment variables:\n- OPENCODE_IMAGE_ASPECT_RATIO: Aspect ratio (e.g., \"16:9\", \"4:3\")\n\nDefaults to 1:1 aspect ratio if not specified.\n\nNote: Resolution setting is not currently supported by the Antigravity API.\n\n**Returns:** ImageConfig\n\n\n### normalizeGeminiTools\n```typescript\nexport function normalizeGeminiTools(\n  payload: RequestPayload,\n):\n```\nNormalize tools for Gemini models.\nEnsures tools have proper function-style format.\n\n**Parameters:**\n- `payload`: RequestPayload - \n\n**Returns:** { toolDebugMissing: number; toolDebugSummaries: string[] }\n\n\n### applyGeminiTransforms\n```typescript\nexport function applyGeminiTransforms(\n  payload: RequestPayload,\n  options: GeminiTransformOptions,\n): GeminiTransformResult\n```\nApply all Gemini-specific transformations.\n\n**Parameters:**\n- `payload`: RequestPayload - \n- `options`: GeminiTransformOptions - \n\n**Returns:** GeminiTransformResult\n\n\n### wrapToolsAsFunctionDeclarations\n```typescript\nexport function wrapToolsAsFunctionDeclarations(payload: RequestPayload): WrapToolsResult\n```\nWrap tools array in Gemini's required functionDeclarations format.\n\nGemini/Antigravity API expects:\n  { tools: [{ functionDeclarations: [{ name, description, parameters }] }] }\n\nNOT:\n  { tools: [{ function: {...}, parameters: {...} }] }\n\nThe wrapper-level 'parameters' field causes:\n  \"Unknown name 'parameters' at 'request.tools[0]'\"\n\n**Parameters:**\n- `payload`: RequestPayload - \n\n**Returns:** WrapToolsResult\n\n\n## Classes\n\n\n## Interfaces\n\n### ImageConfig\n```typescript\nexport interface ImageConfig\n```\nImage generation config for Gemini image models.\n\nSupported aspect ratios: \"1:1\", \"2:3\", \"3:2\", \"3:4\", \"4:3\", \"4:5\", \"5:4\", \"9:16\", \"16:9\", \"21:9\"\n\n\n### GeminiTransformOptions\n```typescript\nexport interface GeminiTransformOptions\n```\nApply all Gemini-specific transformations to a request payload.\n\n\n### GeminiTransformResult\n```typescript\nexport interface GeminiTransformResult\n```\nNo documentation found\n\n\n### WrapToolsResult\n```typescript\nexport interface WrapToolsResult\n```\nNo documentation found\n\n\n## Types\n",
  "metadata": {
    "created_at": "2026-01-30T05:26:52.104Z",
    "updated_at": "2026-01-30T05:26:52.104Z",
    "hash": "515f643d9d7bd150d495c867afe57bf2e76b7d10c85ac2c84e539353c19e7d77",
    "dependencies": [
      "./types"
    ],
    "symbols": [
      "UNSUPPORTED_SCHEMA_FIELDS",
      "toGeminiSchema",
      "inputSchema",
      "result",
      "propertyNames",
      "propName",
      "props",
      "validRequired",
      "isGeminiModel",
      "lower",
      "isGemini3Model",
      "isGemini25Model",
      "isImageGenerationModel",
      "lower",
      "buildGemini3ThinkingConfig",
      "buildGemini25ThinkingConfig",
      "ImageConfig",
      "VALID_ASPECT_RATIOS",
      "buildImageGenerationConfig",
      "aspectRatio",
      "normalizeGeminiTools",
      "toolDebugMissing",
      "toolDebugSummaries",
      "t",
      "newTool",
      "schemaCandidates",
      "placeholderSchema",
      "schema",
      "schemaObjectOk",
      "nameCandidate",
      "fn",
      "GeminiTransformOptions",
      "GeminiTransformResult",
      "applyGeminiTransforms",
      "thinkingConfig",
      "thinkingBudget",
      "generationConfig",
      "tools",
      "result",
      "wrapResult",
      "WrapToolsResult",
      "wrapToolsAsFunctionDeclarations",
      "functionDeclarations",
      "passthroughTools",
      "tool",
      "decl",
      "fn",
      "custom",
      "name",
      "description",
      "schema",
      "finalTools"
    ],
    "complexity_score": 100
  }
}